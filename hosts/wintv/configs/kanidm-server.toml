# Kanidm Server Configuration
# Deploy to: C:\ProgramData\wintv\Kanidm\server.toml
#
# NOTE: Replace {DOMAIN} with your Tailscale domain before deploying
# Example: wintv.example.ts.net

# The webserver bind address. Kanidm will use HTTPS on this port.
bindaddress = "[::]:8443"

# The URL origin of this server (how clients will access it)
# MUST match your actual domain exactly
origin = "https://{DOMAIN}:8443"

# The domain name for the Kanidm instance
domain = "{DOMAIN}"

# Path to TLS certificate and key
# Using Tailscale-generated certs mounted from host
tls_chain = "/data/certs/{DOMAIN}.crt"
tls_key = "/data/certs/{DOMAIN}.key"

# Database location (inside container)
db_path = "/data/kanidm.db"

# Database cache size (256 minimum, auto-scaled if unset)
# db_arc_size = 2048

# Trust the X-Forwarded-For header from reverse proxy
trust_x_forward_for = true

# Log level: default, verbose, perfbasic, perffull
# log_level = "default"

# Role of this server: WriteReplica, WriteReplicaNoUI, ReadOnlyReplica
role = "WriteReplica"

# Admin socket path - must be on tmpfs for Podman on Windows
# Container should be started with: --tmpfs /run/kanidm:rw,size=10m
adminbindpath = "/run/kanidm/kanidmd.sock"
